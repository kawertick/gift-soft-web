<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GiftSoft</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: #0a0a0a;
            color: white;
            min-height: 100vh;
            padding: 0;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 15px;
            padding-bottom: 70px;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px 0;
        }

        .app-title {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #8B5FBF, #6A0DAD);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .content {
            display: none;
        }

        .content.active {
            display: block;
        }

        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
        .bottom-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #1a1a1a;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            padding: 15px;
            border-top: 1px solid #333;
            gap: 10px;
        }

        .menu-item {
            text-align: center;
            color: #666;
            font-size: 12px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .menu-item.active {
            color: #8B5FBF;
        }

        .menu-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }

        /* –ö–µ–π—Å—ã */
        .cases-grid {
            display: grid;
            gap: 20px;
        }

        .case-item {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #333;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .case-item:hover {
            transform: translateY(-5px);
            border-color: #8B5FBF;
        }

        .case-icon {
            font-size: 50px;
            margin-bottom: 15px;
        }

        .case-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #8B5FBF;
        }

        .case-price {
            color: #ffd700;
            font-weight: bold;
            font-size: 16px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–µ–π—Å–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: #1a1a1a;
            border-radius: 20px;
            padding: 25px;
            border: 2px solid #8B5FBF;
            max-width: 350px;
            width: 100%;
            text-align: center;
        }

        .modal-case-icon {
            font-size: 70px;
            margin-bottom: 20px;
        }

        .modal-case-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #8B5FBF;
        }

        .modal-case-price {
            color: #ffd700;
            font-size: 18px;
            margin-bottom: 25px;
        }

        .modal-buttons {
            display: grid;
            gap: 12px;
        }

        /* –î—Ä–æ–ø –∫–µ–π—Å–∞ */
        .drop-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .drop-item {
            background: #252525;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            border: 1px solid #333;
        }

        .drop-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .drop-name {
            font-size: 10px;
            color: #ccc;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .purple-button {
            background: linear-gradient(45deg, #8B5FBF, #6A0DAD);
            border: none;
            padding: 15px;
            border-radius: 12px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease;
            font-size: 16px;
        }

        .purple-button:hover {
            transform: scale(1.05);
        }

        .purple-button:active {
            transform: scale(0.95);
        }

        .outline-button {
            background: transparent;
            border: 2px solid #8B5FBF;
            padding: 15px;
            border-radius: 12px;
            color: #8B5FBF;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .outline-button:hover {
            background: #8B5FBF;
            color: white;
        }

        /* –†—É–ª–µ—Ç–∫–∞ */
        .roulette-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.98);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .roulette-slots {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            height: 100px;
            overflow: hidden;
            position: relative;
        }

        .roulette-track {
            display: flex;
            flex-direction: column;
            gap: 10px;
            animation: scroll 3s ease-out forwards;
        }

        @keyframes scroll {
            0% { transform: translateY(-1000%); }
            100% { transform: translateY(0); }
        }

        .roulette-item {
            width: 80px;
            height: 80px;
            background: #252525;
            border: 2px solid #333;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
        }

        .roulette-result {
            text-align: center;
            font-size: 18px;
            margin-bottom: 20px;
            color: #8B5FBF;
        }

        .reward-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            width: 100%;
            max-width: 300px;
        }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-info {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #333;
            text-align: center;
            margin-bottom: 20px;
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #8B5FBF, #6A0DAD);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            font-weight: bold;
        }

        .user-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: #252525;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            color: #8B5FBF;
            font-weight: bold;
            font-size: 18px;
        }

        .balance-info {
            color: #ffd700;
            font-weight: bold;
            margin: 10px 0;
        }

        .promo-section {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #333;
            margin-bottom: 20px;
        }

        .promo-title {
            text-align: center;
            margin-bottom: 15px;
            color: #8B5FBF;
            font-weight: bold;
        }

        .promo-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .promo-input input {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #333;
            background: #252525;
            color: white;
            outline: none;
        }

        .inventory-section {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #333;
        }

        .inventory-title {
            text-align: center;
            margin-bottom: 15px;
            color: #8B5FBF;
            font-weight: bold;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .nft-item {
            background: #252525;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid #333;
        }

        .nft-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .nft-name {
            font-size: 12px;
            color: #ccc;
        }

        .empty-inventory {
            text-align: center;
            color: #888;
            padding: 30px;
            grid-column: 1 / -1;
        }

        /* –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–æ–∫ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è */
        .button-disabled {
            opacity: 0.5;
            cursor: not-allowed !important;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="app-title">GiftSoft</div>
        </div>

        <!-- –ö–µ–π—Å—ã -->
        <div id="cases-content" class="content active">
            <div class="cases-grid">
                <div class="case-item" onclick="openCaseModal(1)">
                    <div class="case-icon">üéÅ</div>
                    <div class="case-name">–ö–µ–π—Å –ë–æ–º–∂</div>
                    <div class="case-price"><span id="case-price-1">100</span> üé´</div>
                </div>
            </div>
        </div>

        <!-- –ê–ø–≥—Ä–µ–π–¥ -->
        <div id="upgrade-content" class="content">
            <div style="text-align: center; padding: 50px 20px; color: #888;">
                <div style="font-size: 48px; margin-bottom: 15px;">‚ö°</div>
                <div style="color: #8B5FBF;">–†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
            </div>
        </div>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="profile-content" class="content">
            <div class="profile-info">
                <div class="user-avatar" id="user-avatar">U</div>
                <div class="user-name" id="user-name">Username</div>
                <div class="balance-info">–ë–∞–ª–∞–Ω—Å: <span id="user-balance">1000</span> üé´</div>
            </div>

            <div class="user-stats">
                <div class="stat-item">
                    <div>–û—Ç–∫—Ä—ã—Ç–æ –∫–µ–π—Å–æ–≤</div>
                    <div class="stat-value" id="opened-cases">0</div>
                </div>
                <div class="stat-item">
                    <div>NFT –ø–æ–ª—É—á–µ–Ω–æ</div>
                    <div class="stat-value" id="nft-count">0</div>
                </div>
            </div>

            <div class="promo-section">
                <div class="promo-title">üéüÔ∏è –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞</div>
                <div class="promo-input">
                    <input type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥" id="promo-code">
                    <button class="purple-button" onclick="activatePromo()">OK</button>
                </div>
            </div>

            <div class="inventory-section">
                <div class="inventory-title">üéí –ú–æ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å NFT</div>
                <div class="inventory-grid" id="inventory-grid">
                    <div class="empty-inventory">
                        <div style="font-size: 48px; margin-bottom: 15px;">üì¶</div>
                        <div style="color: #888;">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
    <div class="bottom-menu">
        <div class="menu-item active" onclick="showTab('cases')">
            <div class="menu-icon">üéÅ</div>
            <div>–ö–µ–π—Å—ã</div>
        </div>
        <div class="menu-item" onclick="showTab('upgrade')">
            <div class="menu-icon">‚ö°</div>
            <div>–ê–ø–≥—Ä–µ–π–¥</div>
        </div>
        <div class="menu-item" onclick="showTab('profile')">
            <div class="menu-icon">üë§</div>
            <div>–ü—Ä–æ—Ñ–∏–ª—å</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–µ–π—Å–∞ -->
    <div class="modal" id="case-modal">
        <div class="modal-content">
            <div class="modal-case-icon">üéÅ</div>
            <div class="modal-case-name">–ö–µ–π—Å –ë–æ–º–∂</div>
            <div class="modal-case-price"><span id="modal-case-price">100</span> üé´</div>
            
            <div class="drop-grid" id="case-drop">
                <!-- –î—Ä–æ–ø –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω JavaScript -->
            </div>

            <div class="modal-buttons">
                <button class="purple-button" onclick="openRoulette()">–û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å</button>
                <button class="outline-button" onclick="closeModal()">–ù–∞–∑–∞–¥</button>
            </div>
        </div>
    </div>

    <!-- –†—É–ª–µ—Ç–∫–∞ -->
    <div class="roulette-container" id="roulette">
        <div class="roulette-slots">
            <div class="roulette-track" id="roulette-track">
                <!-- –†—É–ª–µ—Ç–∫–∞ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ JavaScript -->
            </div>
        </div>
        <div class="roulette-result" id="roulette-result">–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–µ–π—Å...</div>
        <div class="reward-buttons" id="reward-buttons" style="display: none;">
            <button class="outline-button" id="exchange-btn" onclick="exchangeReward()">–û–±–º–µ–Ω—è—Ç—å –Ω–∞ <span id="exchange-price">0</span> üé´</button>
            <button class="purple-button" id="keep-btn" onclick="keepReward()">–û—Å—Ç–∞–≤–∏—Ç—å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        tg.expand();
        tg.enableClosingConfirmation();

        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userData = {
            balance: 1000,
            openedCases: 0,
            inventory: []
        };

        // –ü–†–ò–í–Ø–ó–ö–ê –ö TELEGRAM
        function initUser() {
            if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                const user = tg.initDataUnsafe.user;
                document.getElementById('user-name').textContent = user.first_name || 'User';
                if (user.first_name) {
                    document.getElementById('user-avatar').textContent = user.first_name[0].toUpperCase();
                }
                document.getElementById('user-balance').textContent = userData.balance;
            } else {
                // Fallback –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                document.getElementById('user-name').textContent = 'Telegram User';
                document.getElementById('user-avatar').textContent = 'T';
            }
        }

        // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ —Å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏ –æ–±–º–µ–Ω–∞
        const cases = {
            1: {
                name: "–ö–µ–π—Å –ë–æ–º–∂",
                icon: "üéÅ",
                price: 100,
                drops: [
                    { 
                        id: "sticker_pack_1", 
                        icon: "üòä", 
                        name: "–ù–∞–±–æ—Ä —Å—Ç–∏–∫–µ—Ä–æ–≤", 
                        chance: 40,
                        exchangePrice: 30 // –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –æ–±–º–µ–Ω–∞
                    },
                    { 
                        id: "emoji_pack", 
                        icon: "üé®", 
                        name: "–ù–∞–±–æ—Ä —ç–º–æ–¥–∑–∏", 
                        chance: 30,
                        exchangePrice: 40
                    },
                    { 
                        id: "premium_stickers", 
                        icon: "‚≠ê", 
                        name: "–ü—Ä–µ–º–∏—É–º —Å—Ç–∏–∫–µ—Ä—ã", 
                        chance: 20,
                        exchangePrice: 60
                    },
                    { 
                        id: "theme_pack", 
                        icon: "üé®", 
                        name: "–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è", 
                        chance: 10,
                        exchangePrice: 80
                    }
                ]
            }
        };

        // –¢–µ–∫—É—â–∏–π –≤—ã–∏–≥—Ä—ã—à
        let currentReward = null;
        let buttonsLocked = false;

        // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–æ–∫
        function lockButtons() {
            buttonsLocked = true;
            document.getElementById('exchange-btn').classList.add('button-disabled');
            document.getElementById('keep-btn').classList.add('button-disabled');
        }

        // –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–µ–π—Å–∞
        function openCaseModal(caseId) {
            const caseData = cases[caseId];
            const dropGrid = document.getElementById('case-drop');
            dropGrid.innerHTML = '';
            
            caseData.drops.forEach(drop => {
                dropGrid.innerHTML += `
                    <div class="drop-item">
                        <div class="drop-icon">${drop.icon}</div>
                        <div class="drop-name">${drop.name}</div>
                        <div style="font-size: 9px; color: #888;">${drop.chance}%</div>
                    </div>
                `;
            });

            document.getElementById('modal-case-price').textContent = caseData.price;
            document.getElementById('case-modal').style.display = 'flex';
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function closeModal() {
            document.getElementById('case-modal').style.display = 'none';
        }

        // –û—Ç–∫—Ä—ã—Ç—å —Ä—É–ª–µ—Ç–∫—É
        function openRoulette() {
            const caseData = cases[1];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
            if (userData.balance < caseData.price) {
                tg.showPopup({
                    title: "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤",
                    message: "–ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞",
                    buttons: [{type: "ok"}]
                });
                return;
            }

            // –°–ø–∏—Å—ã–≤–∞–µ–º –≤–∞–ª—é—Ç—É
            userData.balance -= caseData.price;
            document.getElementById('user-balance').textContent = userData.balance;
            
            document.getElementById('roulette').style.display = 'flex';
            spinRoulette();
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è —Ä—É–ª–µ—Ç–∫–∏ - –§–ò–ö–°: –≤—ã–ø–∞–¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ 1 –ø–æ–¥–∞—Ä–æ–∫
        function spinRoulette() {
            const caseData = cases[1];
            const track = document.getElementById('roulette-track');
            const resultText = document.getElementById('roulette-result');
            
            // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–∑–∞
            const random = Math.random() * 100;
            let accumulatedChance = 0;
            let selectedDrop = null;

            for (const drop of caseData.drops) {
                accumulatedChance += drop.chance;
                if (random <= accumulatedChance) {
                    selectedDrop = drop;
                    break;
                }
            }

            currentReward = selectedDrop;
            buttonsLocked = false;

            // –§–ò–ö–°: –ó–∞–ø–æ–ª–Ω—è–µ–º —Ä—É–ª–µ—Ç–∫—É —Ç–æ–ª—å–∫–æ –≤—ã–∏–≥—Ä—ã—à–Ω—ã–º –ø—Ä–µ–¥–º–µ—Ç–æ–º
            track.innerHTML = '';
            for (let i = 0; i < 15; i++) {
                // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                const randomIcon = "‚ùì";
                track.innerHTML += `<div class="roulette-item">${randomIcon}</div>`;
            }
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –≤ –∫–æ–Ω–µ—Ü
            track.innerHTML += `<div class="roulette-item">${selectedDrop.icon}</div>`;

            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            track.style.animation = 'none';
            setTimeout(() => {
                track.style.animation = 'scroll 3s ease-out forwards';
            }, 10);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Ü–µ–Ω—É –æ–±–º–µ–Ω–∞
            setTimeout(() => {
                resultText.textContent = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏: ${selectedDrop.name}!`;
                document.getElementById('exchange-price').textContent = selectedDrop.exchangePrice;
                document.getElementById('reward-buttons').style.display = 'grid';
            }, 3000);
        }

        // –û–±–º–µ–Ω—è—Ç—å –Ω–∞–≥—Ä–∞–¥—É –Ω–∞ –≤–∞–ª—é—Ç—É
        function exchangeReward() {
            if (buttonsLocked) return;
            lockButtons();
            
            userData.balance += currentReward.exchangePrice;
            document.getElementById('user-balance').textContent = userData.balance;
            
            tg.showPopup({
                title: "üéâ –û–±–º–µ–Ω–µ–Ω–æ!",
                message: `–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${currentReward.exchangePrice} üé´ –∑–∞ –ø–æ–¥–∞—Ä–æ–∫`,
                buttons: [{type: "ok"}]
            });
            
            // –§–ò–ö–°: –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é —Å—Ä–∞–∑—É
            setTimeout(() => {
                closeRoulette();
                closeModal();
            }, 1500);
        }

        // –û—Å—Ç–∞–≤–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
        function keepReward() {
            if (buttonsLocked) return;
            lockButtons();
            
            if (!userData.inventory.includes(currentReward.id)) {
                userData.inventory.push(currentReward.id);
                userData.openedCases++;
                
                document.getElementById('opened-cases').textContent = userData.openedCases;
                document.getElementById('nft-count').textContent = userData.inventory.length;
                updateInventory();
                
                tg.showPopup({
                    title: "üéâ –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å!",
                    message: `${currentReward.name} —Å–æ—Ö—Ä–∞–Ω–µ–Ω`,
                    buttons: [{type: "ok"}]
                });
            }
            
            // –§–ò–ö–°: –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é —Å—Ä–∞–∑—É
            setTimeout(() => {
                closeRoulette();
                closeModal();
            }, 1500);
        }

        // –ó–∞–∫—Ä—ã—Ç—å —Ä—É–ª–µ—Ç–∫—É
        function closeRoulette() {
            document.getElementById('roulette').style.display = 'none';
            document.getElementById('reward-buttons').style.display = 'none';
            document.getElementById('roulette-result').textContent = "–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–µ–π—Å...";
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function updateInventory() {
            const inventoryGrid = document.getElementById('inventory-grid');
            
            if (userData.inventory.length === 0) {
                inventoryGrid.innerHTML = `
                    <div class="empty-inventory">
                        <div style="font-size: 48px; margin-bottom: 15px;">üì¶</div>
                        <div style="color: #888;">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>
                    </div>
                `;
                return;
            }

            inventoryGrid.innerHTML = '';
            userData.inventory.forEach(nftId => {
                const nft = cases[1].drops.find(item => item.id === nftId);
                if (nft) {
                    inventoryGrid.innerHTML += `
                        <div class="nft-item">
                            <div class="nft-icon">${nft.icon}</div>
                            <div class="nft-name">${nft.name}</div>
                        </div>
                    `;
                }
            });
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞
        function activatePromo() {
            const promoCode = document.getElementById('promo-code').value;
            if (!promoCode) return;

            const rewards = {
                'WELCOME100': { balance: 100 },
                'START2024': { balance: 200 }
            };

            if (rewards[promoCode]) {
                userData.balance += rewards[promoCode].balance;
                document.getElementById('user-balance').textContent = userData.balance;
                
                tg.showPopup({
                    title: "üéâ –ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!",
                    message: `–í—ã –ø–æ–ª—É—á–∏–ª–∏ ${rewards[promoCode].balance} üé´`,
                    buttons: [{type: "ok"}]
                });
            }

            document.getElementById('promo-code').value = '';
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤
        function showTab(tabName) {
            document.querySelectorAll('.content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            
            document.getElementById(tabName + '-content').classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            initUser();
            updateInventory();
        });
    </script>
</body>
</html>